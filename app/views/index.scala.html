@(title: String, search: String, pagination: controllers.Application.Pagination, assets: List[models.Asset], library: models.AssetLibrary)


@listFolders(folders: List[models.AssetFolder], cssClass: String) = {
  @if(!folders.isEmpty) {
    <ul @if(!cssClass.isEmpty) { class="@cssClass" } >
    @for(f <- folders) {
        @showFolder(f)
    }
    </ul>
  } 
}

@showFolder(folder: models.AssetFolder) = {
    <li>
        <div class="folder"><a href="#">@{folder.name}</a></div>
        @listFolders(folder.folders, "")
    </li>
}

@displayName(name: String) = {
    @if(name.length > 16) {
        @{name.substring(0,16) + "..."}
    } else {
        @{name}
    }
}

@assetThumbnail(a: models.Asset) = {    
  <div class="asset pull-left">
    <div class="inner-asset">
      <a href="@routes.FileServer.serve(a.original)">
      <img class="thumb" 
        src="@if(a.hasThumbnail) { @routes.FileServer.serve(a.thumbnail) } else { http://placehold.it/96x96 }"/>
      </a>
      <p class="caption">@displayName(a.name)</p>
    </div>
  </div>
}

@pageLink(page: Int, text: String, nav: Boolean) = {
  <li @if(page == pagination.current) { 
        @if(nav) { class="disabled" } else { class="active" }
    } >
    <a href="@routes.Application.index(search, page)">@text</a>
  </li> 
}

@main(title) {

<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <a class="brand titlebrand" href="#">@{title}</a>
    <ul class="nav">
      <li class="divider-vertical"></li>
      <li @if(search.isEmpty) { class="active" } ><a href="/">Show All</a></li> 
      <form class="navbar-form pull-left">
        <input type="text" name="search" id="search" class="span2" value="@{search}"/>
        <button type="submit" class="btn">Submit</button>
      </form>
    </ul>

@if(pagination.total > 1) {
    <div class="pagination pagination-small pull-left pagination-in-navbar">
    <ul>
        @pageLink(0, "|<", true) 
        @pageLink(math.max(pagination.current - 1,0), "<", true)
        @for(p <- pagination.min to pagination.max)  {
            @pageLink(p, (p + 1).toString, false)
        }
        @pageLink(math.min(pagination.current + 1, pagination.total), ">", true)
        @pageLink(pagination.total, ">|", true)
    </ul>
    </div> 
}
    <!-- todo: order -->
    <!--<li class="navbar-text">Order</li>-->
  </div>
</div>

<div class="container-fluid rounded">
  <div class="row-fluid">
    <div class="span2 sidebar">
      <!--Sidebar content-->
      <h6>Keywords</h6>
      @listFolders(library.topFolder.folders, "tree")
    </div>

    <div class="span10 content">
        @for(a <- assets) { @assetThumbnail(a) }
    </div>
  </div>
</div>
}


